function formatDateOnly (dateObject) {	var currDate = dateObject.getDate();	var currMonth = dateObject.getMonth();	currMonth++; // convert month 0-11 in 1-12 	var currYear = dateObject.getFullYear();	return currYear + '-' + (currMonth < 10 ? '0' : '') + currMonth + '-' + (currDate < 10 ? '0' : '') + currDate;};function timeFloat2Str (timeFloat) {			var timeStr = "";	var integerPart = Math.floor(timeFloat);	var decimalPart = ((timeFloat % 1).toFixed(2)) * 1;						timeStr = integerPart + 'h';		if (decimalPart !== 0) {		decimalPart = Math.round(decimalPart * 60); //convertion de centièmes d'heures en minutes		timeStr += decimalPart; 	}	return timeStr;};debugger;var html = '';var dtCollection = ds.Detail_Temps.query("DET_Date >= 2012-10-01 AND DET_Date <= 2012-10-07 order by DET_Date, DPI_ID");var currentDayOfWeek = -1;var previousDayOfWeek = -1;var dayArr = ['Dimanche', 'Lundi', 'Mardi', 'Mercredi', 'Jeudi', 'Vendredi', 'Samedi'];var cumulDayTime = 0;var cumulTotalTime = 0;var currUser = currSession.user;var userFullName = currUser.fullName;html += '<table width="100%"border="0">';//ligne d'entete avec titre des colonneshtml += '<tr>'; // for each array elementhtml += '<td><b>Jour</b></td>';  //nouvelle colonnehtml += '<td><b>Client</b></td>';  //nouvelle colonnehtml += '<td><b>Dossier</b></td>';  //nouvelle colonnehtml += '<td><b>N°</b></td>';  //nouvelle colonnehtml += '<td><b>Temps</b></td>';  //nouvelle colonnehtml += '<td><b>Poste</b></td>';  //nouvelle colonnehtml += '<td><b>Observations</b></td>';  //nouvelle colonnehtml += '</tr>';dtCollection.forEach(function(dt) {try{	currentDayOfWeek = dt.DET_Date.getDay();	if (previousDayOfWeek == -1) { //premier tour de boucle		previousDayOfWeek = currentDayOfWeek;		} else if (currentDayOfWeek !== previousDayOfWeek) { //changement de jour		debugger;        html += '<tr>'; // ligne cumul jour        html += '<td colspan ="4"></td>'; //espace vide        html += '<td>Cumul journalier</td>'; //libellé cumul        html += '<td colspan ="1"></td>'; //espace vide        html += '<td>' + timeFloat2Str(cumulDayTime) + '</td>'; //cumul tepms jour        html += '</tr>';        html += '<tr>'; // ligne cumul jour        html += '<td colspan ="7"></td>'; //espace vide		html += '<td><hr noshade align="center"</td>'; // ligne séparation jour        html += '</tr>';    	previousDayOfWeek = currentDayOfWeek;		cumulTotalTime += cumulDayTime;		cumulDayTime = 0;		    } else {    		}}	catch (err)	{		//	}	cumulDayTime += dt.DET_Temps;	     html += '<tr>'; // for each array element    html += '<td>' + dayArr[currentDayOfWeek] + '&nbsp'+ formatDateOnly(dt.DET_Date) + '</td>'; // Jour    html += '<td>' + dt.Lien_DPI_DT.Lien_DOSPOS_DPI.Lien_DOS_DOSPOS.Lien_SOC_DOSPOS.SOC_RS_Courte + '</td>'; //Client    html += '<td>' + dt.Lien_DPI_DT.Lien_DOSPOS_DPI.Lien_DOS_DOSPOS.DOS_Libelle + '</td>'; //Dossier    html += '<td>' + dt.Lien_DPI_DT.Lien_DOSPOS_DPI.Lien_DOS_DOSPOS.DOS_Numero + '</td>'; //N°    html += '<td>' + dt.DET_heures + '</td>'; //Temps    html += '<td>' + dt.Lien_DPI_DT.Lien_DOSPOS_DPI.Lien_POS_DOSPOS.POS_Code + '</td>'; //Poste    html += '<td>' + dt.DET_Commentaire + '</td>'; //Observation    html += '</tr>';});debugger;html += '<tr>'; // ligne cumul jourhtml += '<td colspan ="4"></td>'; //espace videhtml += '<td>Cumul journalier</td>'; //Tempshtml += '<td colspan ="1"></td>'; //espace videhtml += '<td>' + timeFloat2Str(cumulDayTime) + '</td>'; //Tempshtml += '</tr>';html += '<tr>'; // ligne cumul jourhtml += '<td colspan ="7"></td>'; //espace videhtml += '<td><hr noshade align="center"</td>'; // ligne séparation jourhtml += '</tr>';cumulTotalTime += cumulDayTime;html +='</table>';html += '<h2 align="left"><b>Total Heures : ' + timeFloat2Str(cumulTotalTime) + '</b></h2>'; //cumul temps totalhtml += '<div align="right">Edité le '+formatDateOnly(new Date())+' par '+userFullName + '</div>';html;